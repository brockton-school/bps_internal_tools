{% extends "base.html" %}
{% block title %}Take Attendance Â· TOC Attendance{% endblock %}
{% block content %}
  <div class="card">
    {% if course_name %}
      <div class="meta">Course: <strong>{{ course_name }}</strong></div>
    {% endif %}

    {% if submitted %}
      {% set absent_count = absent_ids|length %}
      {% if absent_count > 0 %}
        <div class="notice">{{ absent_count }} absent recorded. Logged to Google Sheets.</div>
      {% else %}
        <div class="notice">All students present. Logged to Google Sheets.</div>
      {% endif %}
      <a class="btn" href="{{ url_for('toc.index') }}">Start Over</a>
    {% else %}
      <form method="post">
        <input type="hidden" name="block" value="{{ block }}">
        <div class="attendance-instructions" role="note">
          <div class="icon" aria-hidden="true">!</div>
          <div>
            <h2>Mark <span>ABSENT</span> students</h2>
            <p>Select only the students who are not here.</p>
          </div>
        </div>
        <div class="grid">
          {% for s in students %}
            <label class="tile">
              <input type="checkbox" name="absent" value="{{ s['user_id'] }}">
              <span>{{ s['full_name'] }}</span>
            </label>
          {% endfor %}
        </div>
        <button class="btn" type="submit">Submit Attendance</button>
        <a class="btn secondary" href="{{ url_for('toc.select_course', teacher_id=teacher_id) if teacher_id else url_for('toc.index') }}">Back</a>
      </form>
    {% endif %}
  </div>
{% endblock %}
